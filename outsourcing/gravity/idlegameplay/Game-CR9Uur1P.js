var e=Object.defineProperty,t=(t,i,s)=>((t,i,s)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s)(t,"symbol"!=typeof i?i+"":i,s);import{a as i}from"./networkPlugin-Bwiiz7BK.js";class s extends Phaser.GameObjects.Container{constructor(e,i,s){super(e,i??0,s??0),t(this,"ripple_efx"),t(this,"img_finger"),t(this,"finger_container"),t(this,"touch_area"),t(this,"fingerTw",null),t(this,"rippleTw",null),t(this,"isEnable",!1),t(this,"initScale",1),t(this,"evtCallback",(()=>{}));const a=e.add.container(0,0);a.scaleX=2,a.scaleY=2,this.add(a);const n=e.add.ellipse(0,0,128,128);n.isFilled=!0,a.add(n);const o=e.add.image(29,38,"img_finger");o.angle=-32.00000000000006,a.add(o);const r=e.add.rectangle(0,0,3200,3200);r.alpha=1e-5,r.isFilled=!0,this.add(r),this.ripple_efx=n,this.img_finger=o,this.finger_container=a,this.touch_area=r,this.init(),this.addTouchAreaEvt()}touchTw(){this.ripple_efx.setAlpha(0),this.startFingerAnimation()}setEnable(e){this.isEnable=e}bindEvt(e){this.evtCallback=e??(()=>{})}init(){this.setVisible(!1),this.initScale=this.finger_container.scaleX}addTouchAreaEvt(){this.touch_area.setInteractive(),this.touch_area.on("pointerup",(()=>{this.isEnable&&(this.scene.sound.play("SND_Button_Common"),this.evtCallback(),this.scene.tweens.addCounter({from:1,to:0,duration:250,ease:"Power2",onUpdate:e=>{this.setAlpha(e.getValue())},onComplete:()=>{this.setVisible(!1),this.setAlpha(0),this.stopFingerAnimation()}}))}))}startFingerAnimation(){this.setVisible(!0),this.stopFingerAnimation(),this.fingerTw=this.scene.tweens.add({targets:this.img_finger,scale:1.3,duration:300,ease:"Power2",yoyo:!0,repeat:-1,onRepeat:()=>{this.playRippleEffect(),this.scene.sound.play("guide_finger_sfx")}})}stopFingerAnimation(){this.fingerTw&&(this.fingerTw.stop(),this.fingerTw.destroy(),this.fingerTw=null),this.img_finger.setScale(1)}playRippleEffect(){this.rippleTw&&(this.rippleTw.stop(),this.rippleTw.destroy()),this.ripple_efx.isFilled=!1,this.ripple_efx.setScale(.1),this.ripple_efx.setAlpha(1),this.ripple_efx.setStrokeStyle(16,16777215),this.rippleTw=this.scene.tweens.addCounter({from:0,to:1,duration:1e3,ease:"Power2",onUpdate:e=>{const t=e.getValue(),i=.1+2.9*t;this.ripple_efx.setScale(i);const s=1-t;this.ripple_efx.setAlpha(s);const a=16-15*t;this.ripple_efx.setStrokeStyle(Math.max(1,a),16777215)}})}}class a extends Phaser.Scene{constructor(){super("Game"),t(this,"play_video_ins"),t(this,"play_con"),t(this,"player_select_img"),t(this,"right_rect"),t(this,"left_rect"),t(this,"select_con"),t(this,"white_bg"),t(this,"story_intro_img"),t(this,"guideFingerUI"),t(this,"intro_con"),t(this,"isSceneFirstAwake",!0)}editorCreate(){const e=this.add.container(0,0),t=this.add.video(450,800,"gravity-idlegame-play-male-fight");e.add(t);const i=this.add.container(0,0);i.visible=!1;const a=this.add.image(450,674,"player_select_ui");a.scaleX=2,a.scaleY=2,i.add(a);const n=this.add.rectangle(450,800,450,1600);n.setOrigin(0,.5),n.alpha=1e-4,n.isFilled=!0,n.fillColor=7895160,i.add(n);const o=this.add.rectangle(450,800,450,1600);o.setOrigin(1,.5),o.alpha=1e-4,o.isFilled=!0,o.fillColor=7895160,i.add(o);const r=this.add.container(0,0);r.visible=!1;const l=this.add.rectangle(450,800,900,1600);l.isFilled=!0,r.add(l);const h=this.add.image(450,800,"story_intro_1");h.scaleX=2,h.scaleY=2,r.add(h);const c=new s(this,609,927);r.add(c),this.play_video_ins=t,this.play_con=e,this.player_select_img=a,this.right_rect=n,this.left_rect=o,this.select_con=i,this.white_bg=l,this.story_intro_img=h,this.guideFingerUI=c,this.intro_con=r,this.events.emit("scene-awake")}adNetworkSetup(){i(this.scene)}create(){this.adNetworkSetup(),this.editorCreate(),this.events.on("sleep",this.onSceneSleep,this),this.events.on("wake",this.onSceneWake,this),this.sound.play("main_bgm",{volume:1,loop:!0});const e=this.add.particles(0,0,"FX_Star_Big2_128",{lifespan:500,speed:{min:150,max:250},scale:{start:.3,end:0},rotate:{min:0,max:360},alpha:{start:1,end:0},gravityY:100,blendMode:"ADD",tint:16056192,emitting:!1});this.input.on("pointerup",(t=>{this.sound.play("SND_Button_Common"),e.emitParticleAt(t.x,t.y,6),this.createCircleEffect(t.x,t.y),this.createRippleEffect(t.x,t.y)})),this.createIntro()}update(){}createIntro(){this.select_con.setVisible(!1),this.intro_con.setVisible(!0),this.white_bg.setVisible(!0),this.story_intro_img.setAlpha(0),this.story_intro_img.setVisible(!0),this.guideFingerUI.setEnable(!1),this.tweens.chain({targets:this.story_intro_img,tweens:[{duration:750,alpha:1},{delay:1500,duration:750,alpha:0},{onStart:()=>{this.story_intro_img.setTexture("story_intro_2"),this.story_intro_img.setAlpha(0)},duration:750,alpha:1},{delay:1500,duration:750,alpha:0},{onStart:()=>{this.story_intro_img.setTexture("story_intro_3"),this.story_intro_img.setAlpha(0)},duration:750,alpha:1}],onComplete:()=>{setTimeout((()=>{this.guideFingerUI.setEnable(!0),this.guideFingerUI.bindEvt((()=>{this.guideFingerUI.setEnable(!1),this.tweens.add({targets:this.story_intro_img,alpha:0,duration:1500,onComplete:()=>{this.intro_con.setVisible(!1),this.story_intro_img.setVisible(!1),this.createSelect()}})})),this.guideFingerUI.touchTw()}),1e3)}})}createSelect(){this.select_con.setVisible(!0),this.left_rect.setInteractive(),this.left_rect.on("pointerup",(()=>{this.createPlay(!0)})),this.right_rect.setInteractive(),this.right_rect.on("pointerup",(()=>{this.createPlay(!1)}))}createPlay(e){this.select_con.setVisible(!1),this.play_video_ins.changeSource(e?"gravity-idlegame-play-male-fight":"gravity-idlegame-play-female-fight"),this.play_video_ins.setPlaybackRate(.75),this.play_con.setVisible(!0),this.play_video_ins.on("play",(()=>{const e=this.play_video_ins.width*(1600/this.play_video_ins.height);this.play_video_ins.setDisplaySize(e,1600)})),this.play_video_ins.play(),this.play_video_ins.on("complete",(()=>{this.scene.start("Download")}))}onSceneSleep(){}onSceneWake(){}createCircleEffect(e,t){const i=this.add.graphics();i.setDepth(1e3),i.lineStyle(6,16056192,1),i.strokeCircle(0,0,20),i.setPosition(e,t),this.tweens.add({targets:i,scaleX:2,scaleY:2,alpha:0,duration:300,ease:"Power2",onComplete:()=>{i.destroy()}})}createRippleEffect(e,t){const i=this.add.graphics();i.setDepth(1e3),i.lineStyle(1,16056192,.8),i.strokeCircle(0,0,10),i.setPosition(e,t),this.tweens.add({targets:i,scaleX:8,scaleY:8,alpha:0,duration:600,ease:"Power2",onComplete:()=>{i.destroy()}})}shutdown(){this.events.off("sleep",this.onSceneSleep,this),this.events.off("wake",this.onSceneWake,this)}}export{a as default};
